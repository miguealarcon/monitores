<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Monitoreo VANCAN 2026</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    #formulario { display: none; }
    h2 { color: #007bff; }
    label { display: block; margin-top: 10px; }
    input, select, textarea { width: 300px; padding: 5px; margin-top: 5px; }
    button { margin-top: 15px; padding: 10px 20px; background: #007bff; color: white; border: none; cursor: pointer; }
    button:hover { background: #0056b3; }
  </style>
</head>
<body>
  <h2>Login</h2>
  <form id="loginForm">
    <label>Usuario:</label>
    <input type="text" name="usuario" required>
    <label>Contraseña:</label>
    <input type="password" name="password" required>
    <button type="submit">Ingresar</button>
  </form>

  <div id="formulario">
    <h2>Registro de Encuesta</h2>
    <form id="miFormulario">
      <label>Microred:</label>
      <select name="microred">
        <option>ASA</option>
        <option>Miraflores</option>
        <option>Socabaya</option>
      </select>

      <label>Tipo de vacunación:</label>
      <select name="vaccine_type">
        <option>general</option>
        <option>barrido</option>
      </select>

      <label>Fecha:</label>
      <input type="date" name="fecha">

      <h3>I. APERTURA - Participación en la VANCAN</h3>
      <label>Encargado de la VANCAN:</label><input type="number" name="encargado" value="0">
      <label>Inspectores:</label><input type="number" name="inspectores" value="0">
      <label>Cadena de frío:</label><input type="number" name="cadena_frio" value="0">
      <label>Promoción de la salud:</label><input type="number" name="promocion" value="0">
      <label>Vacunadores:</label><input type="number" name="vacunadores" value="0">
      <label>Anotadores:</label><input type="number" name="anotadores" value="0">
      <label>Otros (microred):</label><input type="number" name="otros_microred" value="0">
      <label>Especificar otros:</label><input type="text" name="otros_microred_desc">

      <h3>Participación adicional</h3>
      <label>Municipalidad:</label><input type="number" name="municipalidad" value="0">
      <label>Estudiantes:</label><input type="number" name="estudiantes" value="0">
      <label>Agentes comunitarios:</label><input type="number" name="agentes" value="0">
      <label>Veterinarios particulares:</label><input type="number" name="veterinarios" value="0">
      <label>Otras microredes:</label><input type="number" name="otras_microredes" value="0">
      <label>UPCH y Monitores:</label><input type="number" name="upch_monitores" value="0">
      <label>Otros adicionales:</label><input type="number" name="otros_adicionales" value="0">
      <label>Especificar otros:</label><input type="text" name="otros_adicionales_desc">

      <button type="submit">Guardar registro</button>
    </form>
  </div>

  <script>
    const url = "https://script.google.com/macros/s/AKfycbzC9as7T9qeX_EqsxlFo4KxEPMz8ryW65Vp8W2eXtQ/dev"; // reemplaza con tu URL de Web App

    // Login
    document.getElementById("loginForm").addEventListener("submit", function(e) {
      e.preventDefault();
      const formData = new FormData(this);
      formData.append("login", "true");
      fetch(url, { method: "POST", body: formData })
        .then(res => res.json())
        .then(data => {
          if (data.success) {
            alert("Login correcto");
            document.getElementById("loginForm").style.display = "none";
            document.getElementById("formulario").style.display = "block";
            window.usuarioActivo = formData.get("usuario");
            window.passwordActivo = formData.get("password");
          } else {
            alert(data.message);
          }
        })
      .catch(err => alert("Error en la conexión: " + err));
    });

    // Formulario
    document.getElementById("miFormulario").addEventListener("submit", function(e) {
      e.preventDefault();
      const formData = new FormData(this);
      formData.append("usuario", window.usuarioActivo);
      formData.append("password", window.passwordActivo);
      fetch(url, { method: "POST", body: formData })
        .then(res => res.json())
        .then(data => alert(data.message))
        .catch(err => alert("Error en la conexión: " + err));
    });
  </script>
</body>
</html>

